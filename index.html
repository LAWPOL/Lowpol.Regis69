<!DOCTYPE html>
<html lang="th">
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ô‡∏¥‡∏ï‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå-‡∏£‡∏±‡∏ê‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå 2569</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Itim&display=swap" rel="stylesheet">
  
  
  <style>
    body { 
      font-family: 'Itim', sans-serif;
      background: linear-gradient(90deg, #841111 0%, #a10c0c 100%); 
    }

    .header-banner { 
        color: white; 
        padding: 20px 0; 
    }

    .stat-box {
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 10px;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.2);
    }

    .stat-number { 
        font-size: 1.5rem; 
        font-weight: bold; 
        color: #ffc107; 
    }

    .form-container {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.05);
      margin-top: -30px;
    }

    .btn-submit { 
        background-color: #0d2546; 
        color: white; 
        width: 100%; 
    }

    .btn-submit:hover { 
        background-color: #1e3c72; 
        color: white; 
    }

    .black-ribbon { 
        position: fixed; 
        z-index: 9999; 
        width: 70px; }

    @media only all and (min-width: 768px) { 
        .black-ribbon { 
            width: auto; 
        } 
    }

    .stick-left { left: 0; }
    .stick-right { right: 0; }
    .stick-top { top: 0; }
    .stick-bottom { bottom: 0; }

    .error-text { 
        color: #dc3545; 
        font-size: 0.875em; 
        display: none; 
        margin-top: 5px; 
    }

  </style>
</head>

<body>
  
  <div style="text-align: center; margin: 20px 0;">
    <img src="https://img5.pic.in.th/file/secure-sv1/Logo463bb4b450154ca8.png" 
    alt="Logo ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" 
    style="width: 150px; height: auto;">
  </div>

  <div class="header-banner">
    <div class="container">
      <h2 class="text-center mb-4">‚öñÔ∏è ‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ô‡∏¥‡∏ï‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå-‡∏£‡∏±‡∏ê‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 2569</h2>
      <h3 class="text-center mb-4">‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£ 9 - 13 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569 ‡∏™‡∏≠‡∏ö‡∏Ñ‡∏±‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 22 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569</h3>
      <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="row">
                <div class="col-4">
                    <div class="stat-box">
                        <small>‡∏ä‡∏≤‡∏¢</small>
                        <div id="maleCount" class="stat-number">-</div>
                    </div>
                </div>
        
                <div class="col-4">
                    <div class="stat-box"><small>‡∏´‡∏ç‡∏¥‡∏á</small>
                        <div id="femaleCount" class="stat-number">-</div>
                    </div>
                </div>
                <div class="col-4">
                    <div class="stat-box" style="background: rgba(255,193,7,0.2); border-color: #ffc107;"><small>‡∏£‡∏ß‡∏°</small>
                        <div id="totalCount" class="stat-number">-</div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    <h1 class="text-center mt-4"><span id="currentDateDisplay" class="text-warning fw-bold">...</span></h1>
    <p class="text-center mt-3 mb-2" style="opacity: 0.9;">
        <small>*‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ö‡∏ö Real-time</small>
    </p>
    </div>
  </div>

  <div class="container mb-5">
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="form-container">
          <h4 class="mb-4 text-center">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h4>
          
          <form id="appForm" onsubmit="handleFormSubmit(this)" autocomplete="off">
            
            <div class="mb-3">
              <label class="form-label">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</label>
              <input type="text" class="form-control" name="num_S" required placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£ (‡πÄ‡∏ä‡πà‡∏ô 45001)" maxlength="5">
            </div>

            <div class="mb-3">
              <label class="form-label">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
              <input type="email" class="form-control" name="email_S" required placeholder="example@gmail.com">
            </div>

            <div class="mb-3">
              <label class="form-label">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
              <input type="text" id="idCard" class="form-control" name="ID_S" 
                     required placeholder="x-xxxx-xxxxx-xx-x" 
                     maxlength="17" 
                     oninput="formatIdCard(this)">
              <div id="id-error" class="error-text">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</div>
            </div>

            <div class="mb-3">
              <label class="form-label">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
              <select class="form-select" name="name_T" required>
                <option value="" selected disabled>‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤...</option>
                <option value="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢">‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢</option>
                <option value="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á">‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á</option>
                <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
              </select>
            </div>

            <div class="mb-3">
              <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
              <input type="text" class="form-control" name="name_S" required placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤">
            </div>

            <div class="mb-3">
              <label class="form-label">‡∏ä‡∏±‡πâ‡∏ô</label>
              <input type="text" class="form-control" name="class_S" required placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏±‡πâ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏°.3/12">
            </div>

            <div class="mb-3">
              <label class="form-label">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
              <input type="text" class="form-control" name="school_S" required placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏ï‡∏£‡∏µ‡∏™‡∏¥‡∏£‡∏¥‡πÄ‡∏Å‡∏®">
            </div>

            <div class="mb-3">
              <label class="form-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
              <input type="text" class="form-control" name="phone_S" required placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå ‡πÄ‡∏ä‡πà‡∏ô 08x-xxx-xxxx" maxlength="10">
            </div>

            <div class="mb-3">
              <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á</label>
              <input type="text" class="form-control" name="name_P" required placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á">
            </div>

            <div class="mb-3">
              <label class="form-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á</label>
              <input type="text" class="form-control" name="phone_P" required placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á" maxlength="10">
            </div>

            <div class="mb-3">
              <label class="form-label">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</label>
              <input type="text" class="form-control" name="Relas" required placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå ‡πÄ‡∏ä‡πà‡∏ô ‡∏ö‡∏¥‡∏î‡∏≤">
            </div>

            <div class="mb-3">
              <label class="form-label">‡πÅ‡∏à‡πâ‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Ç‡∏≠‡∏ó‡∏£‡∏≤‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö‡∏Ñ‡∏±‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</label><br>
              <input type="radio" id="wish_yes" name="wishResult" value="‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå" required>
              <label for="wish_yes">‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</label>
              &nbsp;&nbsp; 
              <input type="radio" id="wish_no" name="wishResult" value="‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå">
              <label for="wish_no">‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</label>
            </div>

            <button type="submit" class="btn btn-submit py-2">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£</button>
          </form>
          <div id="message" class="mt-3 text-center" style="display:none;"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ==========================================
    // *** ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ß‡∏≤‡∏á URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy Web App ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ***
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbxUQ7PcKf7DRtTLECMAqX1xhzGtDqppquzB4bQIZXSXZHfqhc5YCSPx6u1BUgRXdLOO/exec'; 
    // ==========================================

    window.onload = function() { 
      checkOpenTime(); 
      displayCurrentDate(); 
      fetchStats(); 
    };
  
    function checkOpenTime() {
      var now = new Date();
      var start = new Date("2026-01-30T07:00:00+07:00");
      var end   = new Date("2026-02-13T23:59:59+07:00");

      if (now < start || now > end) {
         var msg = now < start ? "üö´ ‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£ ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 9 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569 ‡πÄ‡∏ß‡∏•‡∏≤ 07:00 ‡∏ô." : "‚õî ‡∏´‡∏°‡∏î‡πÄ‡∏Ç‡∏ï‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡πâ‡∏ß ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 13 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569 ‡πÄ‡∏ß‡∏•‡∏≤ 23:59 ‡∏ô.";
         document.body.innerHTML = `<img src="https://img5.pic.in.th/file/secure-sv1/black_ribbon_top_leftb3f64429b2018298.png" class="black-ribbon stick-top stick-left"/>
         <div style="background:#a10c0c; min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:center; color:white;">
            <img src="https://img5.pic.in.th/file/secure-sv1/Logo463bb4b450154ca8.png" style="width: 150px; margin-bottom:20px;">
            <h1 style="font-family:'Itim',sans-serif; text-align:center; padding:20px;">${msg}</h1>
            <p style="opacity:0.8;">Develop By LAPSBOY</p>
         </div>`;
      }
    }

    function displayCurrentDate() {
      var date = new Date();
      document.getElementById('currentDateDisplay').innerText = "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà " + date.toLocaleDateString('th-TH', {year: 'numeric', month: 'long', day: 'numeric'});
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (‡∏ú‡πà‡∏≤‡∏ô API)
    function fetchStats() {
      // ‡πÄ‡∏ï‡∏¥‡∏° &t=... ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ Cache
      fetch(GAS_URL + '?action=getStats&t=' + new Date().getTime()) 
        .then(response => response.json())
        .then(stats => {
           document.getElementById('maleCount').innerText = stats.male;
           document.getElementById('femaleCount').innerText = stats.female;
           document.getElementById('totalCount').innerText = stats.total;
        })
        .catch(error => console.error('Error loading stats:', error));
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£
    function formatIdCard(input) {
        let value = input.value.replace(/[^0-9]/g, '');
        let formatted = '';
        if (value.length > 0) formatted += value.substring(0, 1);
        if (value.length > 1) formatted += '-' + value.substring(1, 5);
        if (value.length > 5) formatted += '-' + value.substring(5, 10);
        if (value.length > 10) formatted += '-' + value.substring(10, 12);
        if (value.length > 12) formatted += '-' + value.substring(12, 13);
        input.value = formatted;
        document.getElementById('id-error').style.display = 'none';
    }

    function checkScriptTh(id) {
        if(id.length != 13) return false;
        let sum = 0;
        for(let i=0; i < 12; i++) sum += parseFloat(id.charAt(i)) * (13 - i);
        return (11 - sum % 11) % 10 == parseFloat(id.charAt(12));
    }

    function handleFormSubmit(form) {
      event.preventDefault();
      
      const idInput = document.getElementById('idCard');
      const plainID = idInput.value.replace(/[^0-9]/g, '');
      if (!checkScriptTh(plainID)) {
          alert('‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
          document.getElementById('id-error').style.display = 'block';
          idInput.focus();
          return;
      }

      var btn = form.querySelector('button');
      var originalText = btn.innerText;
      btn.disabled = true;
      btn.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...";
      document.getElementById('message').style.display = 'none';

      // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      data.ID_S = plainID; // ‡∏™‡πà‡∏á‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏µ‡∏î

      // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ GAS ‡∏ú‡πà‡∏≤‡∏ô fetch (POST)
      fetch(GAS_URL, {
        method: 'POST',
        body: JSON.stringify(data) // ‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô Text String ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤ CORS
      })
      .then(response => response.json())
      .then(result => {
         if (result.success) {
            form.reset();
            document.getElementById('message').innerText = "‚úÖ " + result.message;
            document.getElementById('message').style.display = "block";
            document.getElementById('message').className = "mt-3 text-center text-success fw-bold";
            fetchStats(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÉ‡∏´‡∏°‡πà
         } else {
            alert(result.message);
         }
      })
      .catch(error => {
         console.error('Error:', error);
         alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠');
      })
      .finally(() => {
         btn.disabled = false;
         btn.innerText = originalText;
      });
    }
  </script>
</body>
</html>